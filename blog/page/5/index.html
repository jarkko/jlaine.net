
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <script type="text/javascript" src="//use.typekit.net/wpe2bbi.js"></script>
  <script type="text/javascript">try{Typekit.load();}catch(e){}</script>
  <meta charset="utf-8">
  <title>jlaine.net</title>
  <meta name="author" content="Jarkko Laine">

  
  <meta name="description" content="My clear favorite among monospaced fonts has so far been ProFont, 9pt with no antialiasing. I don&#8217;t think antialiasing works well for small &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://jlaine.net/blog/page/5/">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/ender.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="/feed/atom.xml" rel="alternate" title="jlaine.net" type="application/atom+xml">
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link rel="author" href="https://plus.google.com/117033765270760829494/">
  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-84654-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">jlaine.net</a></h1>
  
</hgroup>

</header>
  <!--<nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/feed/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:jlaine.net" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>-->
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2007/12/03/leopard-terminal-doesn-t-like-profont/">Leopard Terminal Doesn&#8217;t Like ProFont</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2007-12-03T00:00:00+02:00" pubdate data-updated="true">Dec 3<span>rd</span>, 2007</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>My clear favorite among monospaced fonts has so far been ProFont, 9pt with no antialiasing. I don&#8217;t think antialiasing works well for small type and I have yet to see as clear and crisp a font as ProFont. However&#8230; this is what a terminal window looks like after I updated to Leopard:</p>
<p><img src="http://jlaine.net/assets/2007/12/2/Leopard_Terminal_with_ProFont-1.jpg" title="Leopard Terminal fucks royally up strings with slashes with ProFont" alt="Leopard Terminal fucks royally up strings with slashes with ProFont" /></p>
<p>Not cool. Here&#8217;s exactly the same window after switching the font to Bitstream Vera Sans Mono:</p>
<p><img src="http://jlaine.net/assets/2007/12/2/Leopard_Terminal_with_Vera_Sans_Mono.jpg" title="In Vera Sans Mono everything&#39;s fine" alt="In Vera Sans Mono everything&#39;s fine" /></p>
<p>Also not cool because of the ugliness but at least all the characters are shown. Anyone got an idea what&#8217;s happening with ProFont? Everything worked just pristine in Terminal in Tiger, and still does if I run iTerm.</p>
<p><strong>[<span class="caps">UPDATE</span>, Dec 3 2007]</strong></p>
<p>I played around with the different ProFont distributions a bit, and the only one that doesn&#8217;t break as above is the bitmap <span class="caps">ATM</span> version of the font. However, as you can see it&#8217;s just plain ugly with small text size (notice the pixelated k, : and ~).</p>
<p><img src="http://jlaine.net/assets/2007/12/3/terminal-profont-bitmap.jpg" alt="" /></p></div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2007/10/25/letting-the-users-choose/">Letting the Users Choose</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2007-10-25T00:00:00+03:00" pubdate data-updated="true">Oct 25<span>th</span>, 2007</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>My friend <a href="http://www.workingwithrails.com/person/5152-martin-sadler">Martin</a> just posted a <a href="http://weblog.workingwithrails.com/2007/10/24/oakley-rails">case study</a> on <a href="http://workingwithrails.com/">Working With Rails</a> about how <a href="http://oakley.com/">Oakley</a> has been migrating their web presence onto Rails. I&#8217;m a big fan of Oakley products. They&#8217;re a company that puts an enormous effort to make seemingly simple products better and better. In orienteering, where you really need some shield for your eyes (unlike in, say, pole vault), glasses with replaceable lenses with different colors for different weather conditions are a must. I&#8217;ve been using the <a href="http://oakley.com/mframe">M Frames</a> for a couple of seasons, and refill my lens stock pretty much every time I visit US.</p>
<p>Martin&#8217;s interview with <a href="http://kenloh.com/">Ken Loh</a> &#8211; the guy running the web group at Oakley &#8211; reveals an interesting point. The guys who actually build their apps got to choose the platform themselves. This is not too surprising for an innovative company such as Oakley, but it does show a clear contrast to the big E word, something <a href="http://www.subtraction.com/archives/2007/1019_if_it_looks_.php">Khoi Vinh</a> and <a href="http://www.37signals.com/svn/posts/669-why-enterprise-software-sucks">Jason Fried</a> have lately talked about:</p>
<blockquote>
<p>The people who buy enterprise software arenâ€™t the people who use enterprise software. Thatâ€™s where the disconnect begins. And it pulls and pulls and pulls until the user experience is split from the buying experience so severely that the software vendors are building for the buyers, not the users. The experience takes a back seat to the feature list, future promises, and buzz words.</p>
</blockquote>
<p>(Jason Fried: <a href="http://www.37signals.com/svn/posts/669-why-enterprise-software-sucks">Why Enterprise Software Sucks</a>)</p></div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2007/09/20/gartner-wisdom/">Gartner Wisdom</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2007-09-20T00:00:00+03:00" pubdate data-updated="true">Sep 20<span>th</span>, 2007</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>In a <a href="http://www.computerworld.com/action/article.do?command=viewArticleBasic&amp;taxonomyId=12&amp;articleId=9037398&amp;intsrc=hm_topic">Computerworld article</a> telling about Steve Jobs and Apple fighting iPhone unlocking (emphasis mine):</p>
<blockquote>
<p>Carolina Milanesi, a Gartner Inc. analyst who was at the London presentation, said she wondered if it matters much in the long run whether Apple stays a step ahead of hackers, as Jobs said it must do. &#8220;At the moment, as a consumer, you need to be very careful about unlocking the iPhone, and know how you want to use it,&#8221; she said. <em>&#8220;If you unlock it, you are not going to have a flat rate, and you will not have access to the 7,500 hot spots.&#8221;</em></p>
</blockquote>
<p>Huh? A 384Kbps (much more than iPhone can handle) flat rate plan runs around €10/month in Finland. And you have access to each and every wifi hotspot in the world with iPhone.</p>
<blockquote>
<p>&#8220;If you unlock and then use the Internet and e-mail, you may be surprised€r first bill,&#8221; she added, referring to the pay-as-you-go data rates charged by most carriers in the country and elsewhere in Europe.</p>
</blockquote>
<p>What the fsck does that have to do with iPhone? You pay what and how you pay regardless of the phone. You probably know what your existing contract charges for data if you&#8217;re contemplating buying and unlocking an iPhone.</p></div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2007/09/19/iphone-vs-nokia-e90-communicator/">iPhone vs. Nokia E90 Communicator</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2007-09-19T00:00:00+03:00" pubdate data-updated="true">Sep 19<span>th</span>, 2007</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p><a href="http://flickr.com/photos/blackhorn/357318034/"><img src="http://farm1.static.flickr.com/147/357318034_64321111a6_m_d.jpg" alt="" /></a> <a href="http://flickr.com/photos/dvdmerwe/1309583957/"><img src="http://farm2.static.flickr.com/1095/1309583957_36c41abf94_m_d.jpg" alt="" /></a></p>
<p>(photos by <a href="http://flickr.com/photos/blackhorn/">Blackhorn</a> and <a href="http://flickr.com/photos/dvdmerwe/">DanieVDM</a>)</p>
<p>The arrival to the second installment of RailsConf Europe &#8211; this time in Berlin &#8211; meant even more for me than hanging around with friends from all over the world. It also meant the first time I was able to hold an <a href="http://www.apple.com/iphone/">iPhone</a> in my own hands.</p>
<p>See, about the same time people in US got their hands on the first iPhones, I also got a new phone, a <a href="http://europe.nokia.com/A4346040">Nokia E90 Communicator</a>. The situation in Finland with the Communicators was almost the same as the one in US with iPhones, it was almost impossible to get one. I was lucky enough to get one in about a week, as a part of a 24-month contract. Here&#8217;s the first-quarter report about my experiences.</p>
<p>First things first. E90 is a pretty impressive device. With full keyboard, Wifi, 3.5G, <span class="caps">GPS</span> and dual screens (of which the larger one is really good) there&#8217;s hardly anything more you could hope. But that&#8217;s just on paper. Much more important to me is how useful the phone is in day-to-day use.</p>
<p>The browser (which uses webkit) is fairly good, certainly one of the best in the mobile world. However, the lack of a &#8220;real&#8221; mouse makes some things really hard, one of the most annoying being the fact that you can&#8217;t scroll an iframe or a div with overflow: scroll. There is no notion of dragging.</p>
<p>One of the most disappointing aspects is the general coherence of Symbian, which unfortunately came as no surprise. Used to OS X, I just don&#8217;t find Symbian stable or slick enough. One example of that is the selection of a Wifi network. In theory, you click the web button, select a Wifi or 3G network and continue to the browser. In practice, about half the time you just end up back to the desktop after selecting the network.</p>
<p>A thing that I was really disappointed by was the <span class="caps">GPS</span>. I&#8217;m not quite sure if it&#8217;s just my device or if it&#8217;s a &#8220;feature&#8221;, but it just takes too long for the device to find itself on the map and there&#8217;s no real feedback on what&#8217;s happening. All the UI says is that there&#8217;s no <span class="caps">GPS</span> available, even though in reality it&#8217;s negotiating with the satellites all the time. If you&#8217;re moving at the same time, the phone won&#8217;t ever be able to locate itself. Therefore, the <span class="caps">GPS</span> function has so far been totally useless for me.</p>
<p>Now that I got to use an iPhone in real life, I can say the two UI&#8217;s are like from different planets. It&#8217;s nice to hear that Nokia and others are coming out with touch screen phones, but I wonder if they ever get it when it comes to usability. Symbian in E90 doesn&#8217;t really reassure me in that regard.</p>
<p>Would I swap my omnipotent Nokia for a device using years-old phone technology? In a heartbeat. While the E90 is really nice and all, it&#8217;s an epitome of feature list competition where the more buzzwords your feature list contains, the better your phone is. And while getting 3.5G speeds is really cool, the coverage is still so bad around Finland that just having Edge for a while (until the 3G iPhone comes out) wouldn&#8217;t be too bad.</p>
<p>It kind of hurts me to say this as a Finn, but at the moment it seems that a newcomer in the mobile phone market has beaten the current leader pretty badly. For the customer and the market in general, that&#8217;s all but certainly a good thing.</p></div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2007/09/06/making-globalize-play-nice-with-specs/">Making Globalize Play Nice With Specs</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2007-09-06T00:00:00+03:00" pubdate data-updated="true">Sep 6<span>th</span>, 2007</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>We&#8217;re using <a href="http://www.globalize-rails.org/globalize/">Globalize</a> for our latest Rails project and I just ran against a problem when running specs with rake.</p>
<p>We specify the base language and the locales our app supports in environment.rb:</p>
<pre><code class="ruby">include Globalize
Locale.set_base_language('en-US')
SupportedLocales.define(['fi-FI', 'sv-SE', 'en-US'], 'en-US')
</code></pre>
<p>However, <code>SupportedLocales.define</code> expects that the language and country data exists in the database, otherwise it will die miserably. Of course, when you run specs with rake, it will wipe the database as its first action so you&#8217;re pretty much out of luck:</p>
<pre><code>.../vendor/plugins/globalize/lib/globalize/localization/supported_locales.rb:282:in `setup': Globalize base language undefined! (RuntimeError)</code></pre>
<p>I fixed this by copying the <code>db:test:clone</code> rake task from <code>[RAILS]/railties/lib/tasks/databases.rake</code> to its own file in <code>lib/tasks</code> and modifying it so that it will load some language and country fixtures automatically:</p>
<pre><code class="ruby">require(File.join(RAILS_ROOT, 'vendor', 'rails', 'activerecord', 'lib', 'active_record', 'fixtures'))

namespace :db do
  namespace :test do
    desc "Recreate the test database from the current environment's database schema"
    task :clone =&gt; %w(db:schema:dump db:test:purge) do
      ActiveRecord::Base.establish_connection(ActiveRecord::Base.configurations['test'])
      ActiveRecord::Schema.verbose = false
      Rake::Task["db:schema:load"].invoke
      Fixtures.create_fixtures("#{RAILS_ROOT}/spec/fixtures", [:globalize_countries, :globalize_languages])
    end
  end
end
</code></pre>
<p>The only thing differing from the original task is the last line creating the fixtures. For some reasons I also need to explicitly require the fixtures file on the top of the file. Aside from this, I needed to change Rakefile in the root of our Rails app to require <code>config/environment.rb</code> instead of <code>config/boot.rb</code> for everything to work.</p>
<p>Of course your fixture files need to include all the languages and countries you&#8217;re specifying in your <code>SupportedLocales.define</code> call.</p>
<p>After these modifications, rake runs through fine again.</p></div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2007/08/22/langaton-tampere/">Langaton Tampere</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2007-08-22T00:00:00+03:00" pubdate data-updated="true">Aug 22<span>nd</span>, 2007</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>It seems that my <a href="http://en.wikipedia.org/wiki/Tampere">wee hometown</a> is getting a <a href="http://www.langatontampere.fi/">citizen wireless network</a> (only in Finnish, unfortunately), based on sharing your own wifi and getting free access to the network using other people&#8217;s access points in exchange. Pretty cool, especially since it&#8217;s opening already this month and I didn&#8217;t even know about it.</p>
<p>(via <a href="http://kalamuki.net/2007/08/21/langaton-tampere">Kalamuki</a>)</p></div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2007/08/06/from-rails-ajax-helpers-to-low-pro-part-2/">From Rails Ajax Helpers to Low Pro, Part 2</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2007-08-06T00:00:00+03:00" pubdate data-updated="true">Aug 6<span>th</span>, 2007</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p><strong>See also:</strong> <a href="http://jlaine.net/2008/9/9/from-rails-ajax-helpers-to-low-pro-part-3-some-announcements">Part 3</a></p>
<p>In the <a href="http://jlaine.net/2007/8/3/from-rails-ajax-helpers-to-low-pro-part-i">first part</a> of this series, we had a look at how we have evolved from using the standard Rails Javascript helpers to first use the <span class="caps">UJS</span> for Rails plugin and then to use Low Pro on its own.</p>
<p>However, there&#8217;s not much documentation about Low Pro yet. In this article, we&#8217;ll introduce Low Pro to you by taking a heavily Ajax-driven, fairly inaccessible Rails page and transforming it to an accessible, unobtrusive one.</p>
<p>We start with a simple todo list application that uses the traditional Rails Javascript helpers. You can <a href="http://jlaine.net/assets/2007/8/6/obtrusive.zip">download the original application from here</a>.</p>
<p><img src="http://jlaine.net/assets/2007/8/6/todo-shot_1.png" title="Todo list app" alt="Todo list app" /></p>
<p>The index page of the items controller is very simple:</p>
<pre><code class="builder">&lt;% form_for :item, :url =&gt; items_path do |f| %&gt;

&lt;h3&gt;
  Not done:
&lt;/h3&gt;

&lt;ul id="undone"&gt;
  &lt;%= render :partial =&gt; "item", :collection =&gt; @not_done %&gt;
&lt;/ul&gt;

&lt;h3&gt;
  Done:
&lt;/h3&gt;

&lt;ul id="done"&gt;
  &lt;%= render :partial =&gt; "item", :collection =&gt; @done %&gt;
&lt;/ul&gt;

&lt;% end %&gt;

&lt;p&gt;
  &lt;%= link_to_function "Add new item", "$('add_form').toggle()" %&gt;
&lt;/p&gt;

&lt;% remote_form_for :item, @new_item, :url =&gt; items_path,
   :html =&gt; {:id =&gt; "add_form", :style =&gt; "display: none;"} do |f| %&gt;
  New item:
  &lt;%= f.text_field :description %&gt;
  &lt;input type="submit" value="Add item"&gt;
&lt;% end %&gt;
</code></pre>
<p>We&#8217;ll take a closer look at the partials later, but let&#8217;s begin with the lower part of the page. There are two kinds of Rails JS helpers used. First, the <code>link_to_function</code> to implement toggling the visibility of the form for adding new items, and second, the <code>remote_form_for</code> for the actual form.</p>
<p>This is how the source looks to a browser:</p>
<pre><code class="html">&lt;p&gt;
  &lt;a href="#" onclick="$('add_form').toggle(); return false;"&gt;Add new item&lt;/a&gt;
&lt;/p&gt;

&lt;form action="/items" id="add_form" method="post" onsubmit="new
  Ajax.Request('/items', {asynchronous:true, evalScripts:true,
  parameters:Form.serialize(this)}); return false;" style="display: none;"&gt;
  New item:
  &lt;input id="item_description" name="item[description]" size="30" type="text" /&gt;

  &lt;input type="submit" value="Add item"&gt;
&lt;/form&gt;
</code></pre>
<p>Above, the anchor tag is both inaccessible and obtrusive. Without Javascript support, nothing happens when you click the resulting link. The Javascript behaviour is also placed right into the tag.</p>
<p>The form tag has a normal action attribute, so it&#8217;s perfectly accessible, as long as the backend supports receiving the form submit without XmlHttpRequest. However, the tag is at least as obtrusive as the link, having the whole <code>Ajax.Request</code> call in the <code>onsubmit</code> event handler.</p>
<p>Let&#8217;s now make the parts accessible, starting with the link. First of all, we&#8217;ll want to make sure the link works even without Javascript. For that, we&#8217;ll modify the helper call to just use the normal link_to.</p>
<pre><code class="ruby">&lt;%= link_to "Add new item", new_item_path %&gt;
</code></pre>
<p>If we now click the link, it will bring us&#8230; nowhere. We don&#8217;t have a new action in our controller. Let&#8217;s create a template (new.rhtml) for it real quick. We don&#8217;t even need to add the action to the controller:</p>
<pre><code class="ruby">&lt;%= render :partial =&gt; "form" %&gt;
</code></pre>
<p>We already have the form in the index template, so let&#8217;s move it to the partial (_form.rhtml) from there&#8230;</p>
<pre><code class="ruby">&lt;% remote_form_for :item, @new_item, :url =&gt; items_path, :html =&gt; {:id =&gt; "add_form", :style =&gt; "display: none;"} do |f| %&gt;
  New item:
  &lt;%= f.text_field :description %&gt;
  &lt;input type="submit" value="Add item"&gt;
&lt;% end %&gt;
</code></pre>
<p>&#8230;and replace it in index.rhtml with a similar render call we just added to new.rhtml.</p>
<p>If we now click the link again, we get to the new page and see&#8230;still nothing. It&#8217;s because the form is invisible. We don&#8217;t want that, so let&#8217;s remove the style attribute from the form partial. We also don&#8217;t want the form to be a remote form by default anymore, it wouldn&#8217;t work well within the separate new page:</p>
<pre><code class="ruby">&lt;% form_for :item, @new_item, :url =&gt; items_path, :html =&gt; {:id =&gt; "add_form"} do |f| %&gt;
  New item:
  &lt;%= f.text_field :description %&gt;
  &lt;input type="submit" value="Add item"&gt;
&lt;% end %&gt;
</code></pre>
<p>We can try to create a new item now but we&#8217;ll get some weird stuff back. Our create action only has an <span class="caps">RJS</span> template so far. Let&#8217;s change the create action in items_controller.rb a bit so that it redirects in case of normal http request:</p>
<pre><code class="ruby">respond_to do |wants|
  wants.html do
    redirect_to items_path
  end
  wants.js
end
</code></pre>
<p>Now creating new items from the new action should work fine.</p>
<h3>Progressive Enhancement</h3>
<p>We have now ensured that adding items works without Javascript and can thus start the progressive enhancement phase. For it, we need the Low Pro javascript library.</p>
<p>Check the code out somewhere on your hard drive:</p>
<pre><code>svn co http://svn.danwebb.net/external/lowpro/trunk lowpro
</code></pre>
<p>And copy the dist/lowpro.js and the behaviours subfolder to your app folder</p>
<pre><code>cp dist/lowpro.js behaviours/*.js [path to your app]/public/javascripts/
</code></pre>
<p>We also need to update prototype to it&#8217;s latest version. Download <a href="http://prototypejs.org/assets/2007/6/20/prototype.js">http://prototypejs.org/assets/2007/6/20/prototype.js</a> and replace the prototype.js in your app with it.</p>
<p>Now you need to load all the needed Javascripts in the layout file (app/views/layouts/items.rhtml):</p>
<pre><code class="ruby">&lt;%= javascript_include_tag :defaults, 'lowpro', 'remote' %&gt;
</code></pre>
<p>We also need a way to pass certain javascript includes for specific pages. We can do this by using the <code>content_for</code> mechanism in Rails. Put the following into the head of your layout template:</p>
<pre><code class="ruby">&lt;%= yield :javascript %&gt;
</code></pre>
<p>Then add the following to your index.rhtml template</p>
<pre><code class="ruby">&lt;% content_for :javascript do %&gt;
  &lt;%= javascript_include_tag "items_index" %&gt;
&lt;% end %&gt;
</code></pre>
<p>This makes the index action to load the Javascript file that is particular to it:</p>
<pre><code class="html">&lt;script src="/javascripts/items_index.js" type="text/javascript"&gt;&lt;/script&gt;
</code></pre>
<p>Now create the items_index.js file in your app&#8217;s public/javascripts folder and we&#8217;re ready to roll!</p>
<p>We&#8217;re using the excellent Event.addBehaviour method in Low Pro to attach behaviours to elements on our page. First of all, we want the form to be hidden when the page loads (remember we removed the css attribute from the element a few lines ago). This makes sure that users who have <span class="caps">CSS</span> working but Javascript not can still see the form.</p>
<pre><code class="javascript">Event.addBehavior({
  '#add_form' : function() {
    this.hide();
  }
});
</code></pre>
<p>Here, we target the form element by its id and then attach a function to it hiding the form. Note that addBehaviour always passes the actual element to the function as <code>this</code>, so it&#8217;s easy to call methods for that element directly.</p>
<p>Next, we want to make clicking the &#8220;Add new item&#8221; link to show the form. We need to first add an id to the link and then attach a behaviour to its click event.</p>
<pre><code class="ruby">&lt;%= link_to "Add new item", new_item_path, :id =&gt; "add_new_link" %&gt;
</code></pre>

<pre><code class="javascript">Event.addBehavior({
  '#add_form' : function() {
    this.hide();
  },
  '#add_new_link:click' : function() {
    $('add_form').toggle();
    return false;
  }
});
</code></pre>
<p>Note how the actual event is separated by a colon from the element id reference. The same way works for all Javascript events, such as <em>submit</em>, <em>focus</em> and <em>blur</em>.</p>
<p>We must remember to make the attached function return false in the end, otherwise browsers will follow through the link (just like would happen if the code was inside an <code>onclick</code> inline event handler).</p>
<p>Ok, our link is now both accessible and unobtrusive. For Javascipt-handicapped it works as a normal link, and for the majority of the users it shows the form inline on the current page.</p>
<p>Next thing to do is to make the form Ajax&#8217;ed again by <a href="http://domscripting.com/blog/display/41">Hijacking</a> it, in Jeremy Keith&#8217;s terms.</p>
<pre><code class="javascript">Event.addBehavior({
  '#add_form' : function() {
    this.hide();
  },
  '#add_new_link:click' : function() {
    $('add_form').toggle();
    return false;
  },
  '#add_form' : Remote.Form
});
</code></pre>
<p>Hold it! What&#8217;s that? We&#8217;re not attaching a function to the element anymore. Remote.Form is a <em>Low Pro behaviour class</em>, a fairly recent addition in the library. Behaviour classes can be used to encapsulate common behaviour that you would put into an attached function inside <code>addBehaviour</code>. <code>Remote.Form</code> and <code>Remote.Link</code> are good examples of behaviour that is pretty much the same all the time. They will automatically hijack a form or link respectively, and make them use Ajax. We could specify a bunch of attributes to the calls, but most of the time <em>they just work</em>, getting all the needed info from the actual <em>form</em> and <em>a</em> elements.</p>
<p>However, we now have one problem. Since we&#8217;re attaching another behaviour to #add_form already, the latter will override the first one and the form is not hidden on the page. We could overcome this by writing our own behaviour class. However, we will take a short cut here and hide the form when the body is loaded, instead:</p>
<pre><code class="javascript">Event.addBehavior({
  'body' : function() {
    $('add_form').hide();
  },
  '#add_new_link:click' : function() {
    $('add_form').toggle();
    return false;
  },
  '#add_form' : Remote.Form
});
</code></pre>
<p>Ta-da! Our link and form now work just like they did in the beginning. However, now the code works even when JS is turned off. The produced <span class="caps">HTML</span> now looks like this:</p>
<pre><code class="html">&lt;p&gt;
  &lt;a href="/items/new" id="add_new_link"&gt;Add new item&lt;/a&gt;
&lt;/p&gt;

&lt;form action="/items" id="add_form" method="post"&gt;
New item:
&lt;input id="item_description" name="item[description]" size="30" type="text" /&gt;
&lt;input type="submit" value="Add item"&gt;
&lt;/form&gt;
</code></pre>
<p>Isn&#8217;t that just beautiful?</p>
<p>This is a good time to have a short break and digest what you&#8217;ve learned so far. In the next installment, we&#8217;ll tackle the select box lists of todo items and see how you can unobtrusively attach behaviours to multiple elements with very small amount of code.</p>
<p>Now, continue to the <a href="http://jlaine.net/2008/9/9/from-rails-ajax-helpers-to-low-pro-part-3-some-announcements">next part of the series</a>.</p></div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2007/08/03/from-rails-ajax-helpers-to-low-pro-part-i/">From Rails Ajax Helpers to Low Pro, Part I</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2007-08-03T00:00:00+03:00" pubdate data-updated="true">Aug 3<span>rd</span>, 2007</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p><strong>[<span class="caps">UPDATE</span>]</strong> Links to the latter parts of the series:</p>
<ul>
	<li><a href="http://jlaine.net/2007/8/6/from-rails-ajax-helpers-to-low-pro-part-2">Part 2</a></li>
	<li><a href="http://jlaine.net/2008/9/9/from-rails-ajax-helpers-to-low-pro-part-3-some-announcements">Part 3</a></li>
</ul>
<p>In a recent Ruby on Rails podcast interview, Dan Webb stated he&#8217;d rather see the Javascript and Ajax helpers removed from the Rails core. What was the reason a prominent Rails figure like Dan holds such a radical view on the helpers?</p>
<p>When Rails was young and only gaining popularity, its ability to help in quickly building Ajax-equipped web applications was one of the biggest selling points for the framework. In this, helpers such as <code>link_to_remote</code> and <code>remote_form_tag</code> played a big role. However, there are two problems looming with the Rails helpers. While the helpers did manage to make writing Ajax applications as easy as not to, they also made it very easy to fall into the two major culprits of Javascript development: writing inaccessible web applications and obtrusive JS code.</p>
<h3>Accessibility</h3>
<p>Accessibility in the scope of Javascript can be capped with a single sentence: Can users use the web page if Javascript is not working in their browser? For the longest amount of time, Javascript was considered synonymous to inaccessible web sites. It took a lot of evangelizing (including <a href="http://domscripting.com/">a book</a> by <a href="http://adactio.com/">Jeremy Keith</a>) to convince people that peppering your pages with Javascript doesn&#8217;t inherently mean they&#8217;re inaccessible.</p>
<p>The technique to create sites that worked both with and without Javascript was originally called <a href="http://www.cs.tut.fi/~jkorpela/html/augm.html">graceful degradation</a>. The page would degrade gracefully to a less advanced one if Javascript wasn&#8217;t enabled in the browser. However, people weren&#8217;t happy with the success of graceful degradation in the larger web design circles. Therefore the strategy was basically reversed and the newcomer was labeled <a href="http://en.wikipedia.org/wiki/Progressive_enhancement">Progressive enhancement</a>. The idea behind progressive enhancement is that you first build the basic functionality of the page that is available to all users, and only after that build more advanced features on that foundation.</p>
<p>Code produced by Rails Javascript helpers isn&#8217;t necessarily inaccessible. <code>remote_form_tag</code> sets the action of the form tag to the same url as the target of the Ajax call, so even if the browser doesn&#8217;t support Javascript, the form should work fine:</p>
<pre><code class="html">&lt;form action="/items" id="add_form" method="post" 
onsubmit="new Ajax.Request('/items', {asynchronous:true, 
  evalScripts:true, parameters:Form.serialize(this)}); 
  return false;" 
style="display: none;"&gt;
</code></pre>

<p>Even <code>link_to_remote</code> and <code>link_to_function</code> give you the option to specify the href attribute manually and thus make the link accessible:</p>
<pre><code class="ruby">&lt;%= link_to_function "Add new item", 
    "$('add_form').toggle()", :href =&gt; "/foo" %&gt;
</code></pre>
<p>âž¥</p>
<pre><code class="html">&lt;a href="/foo" 
   onclick="$('add_form').toggle(); return false;"&gt;
  Add new item
&lt;/a&gt;
</code></pre>

<p>However, the problem is that by default the href attribute is set to &#8220;#&#8221; (which leads nowhere), which provides an easy way to the developer to cut corners and leave the Javascript-disabled out in the cold:</p>
<pre><code class="ruby">&lt;%= link_to_function "Add new item", 
    "$('add_form').toggle()" %&gt;
</code></pre>
<p>âž¥</p>
<pre><code class="html">&lt;a href="#" onclick="$('add_form').toggle(); return false;"&gt;
  Add new item
&lt;/a&gt;
</code></pre>
<p>Not surprisingly, many if not most Rails developers take the easy way out and just go with the default.</p>
<h3>Obtrusiveness</h3>
<p>Web evangelists have for long touted the wonders of separating the structure and presentation of web pages by using semantic <span class="caps">HTML</span> for structure and <span class="caps">CSS</span> stylesheets for styling the presentation. There is, however, a third part belonging to that separation equation, <a href="http://www.alistapart.com/articles/behavioralseparation">the behaviour</a>. Behaviour is what Javascript is taking care of in web sites.</p>
<p>The separation of concerns is <a href="http://en.wikipedia.org/wiki/Model-view-controller">nothing new in the software world</a>, and is fairly far even in the case of <span class="caps">CSS</span>. However, many still cobble their <span class="caps">HTML</span> views up with smaller or (more often) larger chunks of Javascript. This kind of Javascript usage is called obtrusive.</p>
<p>In unobtrusive Javascript, the <span class="caps">HTML</span> view should be left clean of Javascript. Instead, the elements are given id and class attributes that can then be used in separate Javascript files to attach behaviour to the elements. Consider the following bit of code:</p>
<pre><code class="html">&lt;a href="/foo" 
   onclick="$('add_form').toggle(); return false;"&gt;
  Add new item
&lt;/a&gt;
</code></pre>
<p>Using Low Pro, this could easily be made unobtrusive:</p>
<p><span class="caps">HTML</span> file</p>
<pre><code class="html">&lt;a href="/foo" id="add_item_link"&gt;
  Add new item
&lt;/a&gt;
</code></pre>
<p>Javascript file</p>
<pre><code class="javascript">Event.addBehavior({
  '#add_new_link:click' : function() {
    $('add_form').toggle();
    return false;
  }
});
</code></pre>
<p>This not only makes the code cleaner and puts the behaviour code where it should be, it also makes it a lot more natural to begin by making the pure-<span class="caps">HTML</span> version work before starting to attach behaviours to it.</p>
<h3>The path to enlightenment</h3>
<p>Ever since the beginning of Ajax support in Rails, people wanted a way to make their apps more accessible (read the comments in my post <a href="http://jlaine.net/2005/8/25/using-rails-ajax-helpers-to-create-safe-state-changing-links">Using Rails <span class="caps">AJAX</span> helpers to create safe state-changing links</a> for discussion about making the href attribute default to the url given to link_to_remote) and unobtrusive.</p>
<p>In 2006 <a href="http://www.danwebb.net/">Dan Webb</a> and <a href="http://www.lukeredpath.co.uk/">Luke Redpath</a> came out with the <a href="http://www.ujs4rails.com/">Unobtrusive Javascript for Rails</a> plugin. The plugin did a bunch of things:</p>
<ul>
	<li>It modified the Rails Ajax helpers so that they won&#8217;t just add inline event handlers to the <span class="caps">HTML</span> code but instead add a dom id to the element (if one didn&#8217;t already exist) and attach an event to the element in an external Javascript file that is created and cached on the fly.</li>
	<li>It added a helper called <code>apply_behaviour</code> that you could use to attach behaviour to elements by hand, using either pure Javascript or the domain-specific Ruby language familiar from the <span class="caps">RJS</span> templates. The helper used a CSS3 selector-like syntax (also familiar from the <a href="http://prototypejs.org/api/utility/dollar-dollar"><code>$$</code></a> prototype method and <a href="http://api.rubyonrails.org/classes/ActionController/Assertions/SelectorAssertions.html#M000208"><code>assert_select</code></a> Rails test assertion) to select to which elements certain behaviours should be attached.</li>
</ul>
<pre><code class="ruby">&lt;% apply_behaviour "#add_item_link:click", "alert('Foo clicked!')" %&gt;
  
&lt;% apply_behaviour "#another_link:click" do |page|
    page.alert "Ah, you clicked me again"
  end %&gt;
</code></pre>
<ul>
	<li>It added a couple of helpers to be used with <code>apply_behaviour</code> to call the most common <a href="http://prototypejs.org/">prototype</a> and <a href="http://script.aculo.us/">script.aculo.us</a> effects:</li>
</ul>
<pre><code class="ruby">&lt;% apply_behaviour "#sort_list", make_sortable %&gt;

&lt;% apply_behaviour ".ajax_link", make_remote_link %&gt;
</code></pre>
<p>Under the hood of the plugin was Dan&#8217;s Low Pro Javascript library, a light set of Javascript that makes it easier to produce accessible and unobtrusive Javascript using prototype and script.aculo.us. Low Pro introduced a few additions to the prototype element accessor methods (many of which have later been brought into prototype itself), a <span class="caps">DOM</span> builder, and, most important, event handling code that include declarative behaviours:</p>
<pre><code class="javascript">Event.addBehavior({
  'a.todo:click' : Link.Remote,
  'div.feature:mouseover' : function(e) {
    this.hide();
  }
});
</code></pre>
<p>As you can see, the first part of the elements in the array is the same kind of selector used in <code>apply_behaviour</code> &#8212; actually <code>apply_behaviour</code> builds this kind of Javascript calls from the Ruby code it receives. After the colon you specify either a function to be called upon the event or a <em>behaviour</em> class to be used (we will talk more about them in part 2). With <code>addBehaviour</code>, you &#8220;<a href="http://domscripting.com/presentations/xtech2006/">hijack</a>&#8221; the basic functionality of the page and spice it with more advanced behaviour that wouldn&#8217;t be possible without Javascript.</p>
<p>While <span class="caps">UJS</span> was (and still is) a great step forward in making Javascript in Rails apps more unobtrusive &#8211; we still use it heavily on dotherightthing.com &#8211; it also has it problems. My biggest gripe with it is that while the produced <span class="caps">HTML</span> is clean of any Javascript, the <code>apply_behaviour</code> calls were still in the view code, polluting the <span class="caps">RHTML</span> views <em>I</em> was looking at days in days out. In June Dan posted a blog article titled <a href="http://www.danwebb.net/2007/6/16/the-state-and-future-of-the-ujs-plugin">The State (And Future) Of The <span class="caps">UJS</span> Plugin</a>. In the article he writes that he&#8217;s lately not used the plugin at all and that he&#8217;s found it much better to just use Low Pro on its own without the Ruby scaffolding:</p>
<blockquote>
<p>Essentially, the status is that, of late, I personally have not used <span class="caps">UJS</span> at all and have found a much better process by using Low Pro on its own without all the Ruby scaffolding of the <span class="caps">UJS</span> plugin. Secondarily, after talking to lots of developers at RailsConf it seems that the <span class="caps">UJS</span> plugin has failed to truly achieve itâ€™s main goal which is to get Rails developers to write JavaScript using progressive enhancement. Many people seem to mainly use the plugin to get their JavaScript in to a separate file which is actually not even essential to progressive enhancement and I think this is a failing in the design of <span class="caps">UJS</span> itself. To achieve progressive enhancement you really need to think of JavaScript as a separate layer on top of a working <span class="caps">HTML</span> application but <span class="caps">UJS</span> lets you get away with keeping behavior in your views and hence leads many developers to think in the same way as they did before but think they are unobtrusive because they donâ€™t see any JavaScript in their <span class="caps">HTML</span> â€“ which is obviously not what we wanted to achieve. While many people can and do successfully use <span class="caps">UJS</span> for progressive enhancement even more seem not to â€“ <span class="caps">UJS</span> has not been the â€˜angel on your shoulderâ€™ that I originally wanted it to be.</p>
</blockquote>
<p>That single paragraph pretty much sums up my thoughts as well. And as many other people noted in the comments of the article that they, too, were mostly using just plain Low Pro instead of the plugin, I decided to give it a serious go as well. So for a recent project (a heavily Ajax-driven system) I just started writing everything without Javascript at first and then using Low Pro to progressively enhance the user experience with Ajax and other Javascript behaviours. Guess what &#8211; it&#8217;s worked wonderfully. I&#8217;m inclined to say I will never use a Rails Javascript or Ajax helper anymore. It was always more work to make them accessible than to just start with the barebones functionality and add the Javascript with Low Pro afterwards.</p>
<p>One initial fear I had was about dynamic serverside data that I could use with the <span class="caps">UJS</span> plugin.  But that turned out not to be a problem at all. The cool thing about the Low Pro behaviours is that they have access to all the data on the page (even after updated by Ajax). That means you can use element id and class attribute values and the actual dynamic element content to your heart&#8217;s content. And if you really need to pass something special to the JS script alone, you can always set response headers that are then read by the Javascript code.</p>
<p>That&#8217;s it for part 1. Next week, in <a href="http://jlaine.net/2007/8/6/from-rails-ajax-helpers-to-low-pro-part-2">part 2</a>, we&#8217;ll dissect an Ajax-driven, fairly inaccesible Rails page, and see how we can easily make it both accessible and unobtrusive with a few simple steps. Stay tuned!</p></div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2007/07/31/dubbing-of-the-simpsons-movie/">Dubbing of the Simpsons Movie</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2007-07-31T00:00:00+03:00" pubdate data-updated="true">Jul 31<span>st</span>, 2007</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p><a href="http://unicast.org/blog/1622">Guan brings up</a> an interesting point about <a href="http://imdb.com/title/tt0462538/">The Simpsons Movie</a>. Just like in Denmark, it&#8217;s distributed here both as original and a dubbed Finnish version. It&#8217;s been common to dub films here that are clearly targeted at small children. However, dubbing Simpsons is interesting for two reasons:</p>
<ol>
	<li>Just like in Denmark, Simpsons the series has never been dubbed in the Finnish TV. People, even the children, are used to the certain American voices the characters have.</li>
	<li>From what Iâ€™ve heard (I&#8217;ve yet to see the film) Simpsons the Movie is not really a childrenâ€™s movie at all, just like the series has never been aimed at children that can&#8217;t yet read.</li>
</ol></div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2007/07/27/a-tale-of-a-cheque/">A Tale of a Cheque</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2007-07-27T00:00:00+03:00" pubdate data-updated="true">Jul 27<span>th</span>, 2007</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>One thing that never stops amazing me is the eagern€US companies to use cheques as a pa€ethod. I mean, we have been using online banks for more than a decade now, and still the default way of paying a contractor is sending him a cheque.</p>
<p>Sure, the buyer wins some time (and thus a few days&#8217; worth of interest€or the receiver of the payment it goes like this:</p>
<ol>
	<li>Wait for the cheque to arrive in mail. This normally takes about a week.</li>
	<li>Walk to a bank and get stared at like a lunatic, because you&#8217;re considered a remnant from the era of <a href="http://www.eero-aarnio.com/8/Objects/Ball_Chair.htm">ball chairs</a>. Stand in line for half an hour because banks have cut their counter workers to a minimum (since no one &#8211; except for pensioners &#8211; goes to a bank persionally these days, and pensioners have time to wait).</li>
	<li>Wait another week for the cheque to be cashed and the money to arrive on your account.</li>
</ol>
<p>Now let&#8217;s compare this to the process of a bank wire:</p>
<ol>
	<li><em class="laughter">&#8230; there is no step 1.</em> You just wait and after about a week since the customer sends the money it&#8217;s on your account.</li>
</ol>
<p>Now as if this wasn&#8217;t enough, here&#8217;s what just happened with a cheque I received a couple of months ago. When I got the cheque, the dollar rate was near it&#8217;s all-time low (around $1.35/€1), so I decided I&#8217;d wait for a while for it to stabilize. That turned out to be just a pipe dream so I bit the bullet and walked into a bank this week. No problem.</p>
<p>Today I got a call from the bank. They told me they have a 70-day limit in cashing cheques in the normal fashion (which costs me about €12). Since they don&#8217;t want to take the risk of being denied by the US bank that issued the cheque, the only way to cash it now is as a <span class="caps">CAD</span> (cash against documents) cheque, which, coincidentally, is going to cost me around €50. Just great.</p>
<p>For a reality check, I decided to call <a href="http://www.nordea.fi">another bank</a> and ask how it would work there. The person with whom I talked obviously wasn&#8217;t prepared to answer such a hard question as &#8220;How much does cashing a cheque cost?&#8221;, so I had to wait on hold for a while until she came back with the answer. And what an answer that was:</p>
<p>&#8220;The bank has the option to deny cashing the cheque as its will, and the cost is always at least €90.&#8221; Geez. I called back to the original bank and told them to go ahead with the cashing. It seems the banks in Finland have  at least as bad an aversion to cheques as I do.</p>
<p>From no on, please don&#8217;t offer to pay me by a chequ</p></div>
  
  


    </article>
  
  <div class="pagination">
    
      <a class="prev" href="/blog/page/6/">&larr; Older</a>
    
    <a href="/blog/archives">Blog Archives</a>
    
    <a class="next" href="/blog/page/4/">Newer &rarr;</a>
    
  </div>
</div>

    </div>
  </div>
  <footer role="contentinfo"><ul>
  <li><a href="http://jlaine.net/jarkko">About Jarkko</a></li>
  <li><a href="http://notkea.fi"><strong>NOTKEA.FI</strong> – Notkeita ajatuksia taloudesta, teknologiasta ja elämästä suomeksi</a></li>
</ul>

<p>
  Copyright &copy; 2014 - Jarkko Laine -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>
</footer>
  







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>



<script type="text/javascript">
  var _gauges = _gauges || [];
  (function() {
    var t   = document.createElement('script');
    t.type  = 'text/javascript';
    t.async = true;
    t.id    = 'gauges-tracker';
    t.setAttribute('data-site-id', '50b05efb613f5d7127000040');
    t.src = '//secure.gaug.es/track.js';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(t, s);
  })();
</script>

</body>
</html>
