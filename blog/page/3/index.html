
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <script type="text/javascript" src="//use.typekit.net/wpe2bbi.js"></script>
  <script type="text/javascript">try{Typekit.load();}catch(e){}</script>
  <meta charset="utf-8">
  <title>jlaine.net</title>
  <meta name="author" content="Jarkko Laine">

  
  <meta name="description" content="I&#8217;ve been working with Merb and DataMapper in the context of a new project for a week now, and the experience has been both pleasant and &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://jarkko.github.com/jlaine/blog/page/3/">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/ender.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="/feed/atom.xml" rel="alternate" title="jlaine.net" type="application/atom+xml">
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-84654-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">jlaine.net</a></h1>
  
</hgroup>

</header>
  <!--<nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/feed/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:jarkko.github.com/jlaine" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>-->
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2008/06/02/specifying-indeces-in-datamapper/">Specifying Indeces in DataMapper</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2008-06-02T00:00:00+03:00" pubdate data-updated="true">Jun 2<span>nd</span>, 2008</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>I&#8217;ve been working with <a href="http://merbivore.com/">Merb</a> and <a href="http://datamapper.org/">DataMapper</a> in the context of a new project for a week now, and the experience has been both pleasant and interesting. On one hand the stack is solid and super-fast (like, desktop app fast), on the other there are a lot of things that catch you if you don&#8217;t manage to remove the Rails hat off your head. The youth of the frameworks still shows (especially in DataMapper which has recently seen a major refactoring to make it more modular the same way Merb was reworked a bit earlier) but at the same time I get the chance to help with some really cool up-and-coming open source software. If you don&#8217;t consider that a plus, maybe you should still wait a couple months before you consider these critters for a production app.</p>
<p>One clear symptom of the young age of both Merb and DataMapper is the lack of documentation. They both have documentation sections on their respective websites and there are other efforts such as Merbunity going on, but you still have to have the guts to dive into the source code if you want to find out how some of the less common use cases work.</p>
<p>Here&#8217;s a short piece on how to declare indeces for your DataMapper models. I plan to continue publishing this kind of tutorials for other functionality as well, and to contribute them back to the &#8220;official&#8221; docs when appropriate.</p>
<h2>The big difference</h2>
<p>The big conceptual different between ActiveRecord and DataMapper is that in ActiveRecord, the place where the properties of database tables are defined are the migration files. The actual tables are then built according to the migrations and the actual model classes build their property to methods from the database schema.</p>
<p>In DataMapper, the properties are defined in the actual model file. DM has so called auto migrations that compare the model file and the database schema, and modify the schema if the two don&#8217;t match.</p>
<p>Here&#8217;s an example DataMapper model:</p>
<pre><code class="ruby">class User
  include DataMapper::Resource

  property :id,         Integer, :serial =&gt; true
  property :first_name, String
  property :last_name,  String
  property :bio,        Text
  property :single,     Boolean
end
</code></pre>
<p>Seems clean, doesn&#8217;t it. Looking at a model it is clear what properties it has and what methods it supports. But what about indeces? In AR migrations, you would use the <code>create_index</code> method. In DataMapper, <code>index</code> is an option given to the <code>property</code> method:</p>
<pre><code class="ruby">property :last_name,    String, :index =&gt; true
</code></pre>
<p>Or, if you want the index to be unique:</p>
<pre><code class="ruby">property :last_name,    String, :unique_index =&gt; true
</code></pre>
<p>OK, but what if you need multi-column composite indeces? Easy. Instead of <code>true</code>, give the index a name using a symbol:</p>
<pre><code class="ruby">property :last_name,     String, :index =&gt; :name
property :first_name,    String, :index =&gt; :name
</code></pre>
<p>This will create an index called <code>index_products_name</code> for the table, spanning columns <code>last_name</code> and <code>first_name</code>. <strong>The columns are added to the index in order of appearance</strong>, so in this case the indexing order would be <em>last name, first name</em>. If you want to change that order, just change the order of you <code>property</code> calls in the model call definition.</p>
<p>There you have it! No rocket surgery, but something I had to dive into the source code to find out.</p></div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2008/05/25/start-from-the-heart/">Start From the Heart</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2008-05-25T00:00:00+03:00" pubdate data-updated="true">May 25<span>th</span>, 2008</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>My friend <a href="http://pinds.com/">Lars Pind</a> is slowly migrating himself from a software developer to a coach. His new startup is called <a href="http://startfromtheheart.com/">Start from the Heart</a>, where Lars tries to help people start companies that represent their true soul. The guiding principle behind Start from the Heart is that there should be a deeper meaning in the business you pursue than just the money. As exactly that has been a driving force behind us at <a href="http://dotherightthing.com">dotherightthing.com</a>, it&#8217;s no wonder the premise of SftH really resonated with me.</p>
<p>Lars is putting up <a href="http://startfromtheheart.com/blog/">a series of exercises</a> for the participants of the program and giving out them for free. I worked through <a href="http://startfromtheheart.com/heroes/">the first assignment</a> and must say that it&#8217;s a great one, getting a smile on your face. If you&#8217;re thinking about starting your own company (or have ever contemplated it), I would highly recommend giving Start from the Heart a try. I&#8217;m certainly enjoying it from the bottom of my heart (no pun intended).</p></div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2008/05/08/amp-lified/">&amp;lified</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2008-05-08T00:00:00+03:00" pubdate data-updated="true">May 8<span>th</span>, 2008</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p><strong><span class="caps">UPDATE</span></strong> Now <a href="http://ampersand.gosedesign.net/">ampersand even has its own blog</a>.</p>
<p>Ampersand has received a lot of <a href="http://www.typography.com/ask/showBlog.php?blogID=98">press</a> <a href="http://www.kottke.org/08/05/ampersands">lately</a> and I decided to put my oar in as well.</p>
<p>My recent history with ampersand is kind of embarrassing, to say the least. I was giving a Ruby class in UK a few years back and during a class, I asked a participant whether there is some other term for the <em>at sign</em> in English. &#8220;Sure&#8221;, she said, &#8220;it&#8217;s ampersand.&#8221; To this day I&#8217;m not sure whether she thought I said <em>et sign</em>, or genuinely mixed up <a href="http://en.wikipedia.org/wiki/Asperand">asperand</a> and <a href="http://en.wikipedia.org/wiki/Ampersand">ampersand</a>. But for quite some time after that, I happily treated @ as ampersand.</p>
<p>But neither linguistics or typography is the topic of today&#8217;s article. Let&#8217;s rather talk about ampersand (the real one) in Ruby.</p>
<p>In Ruby, an ampersand denotes a block parameter. But let&#8217;s not get ahead of ourselves. A little background might be in place.</p>
<p>One of the coolest features in Ruby are <em>code blocks</em>, or <em>closures</em>. <del>They are basically anonymous functions, but as pretty much everything in Ruby, they are also objects.</del> They are anonymous functions, that have little use just by themselves. However, you can turn them into <code>Proc</code> objects either with the <code>Proc.new</code> constructor or using the <code>lambda</code> kernel method. The common best practice to mark code blocks is to use the curly braces with one-liners and <code>do..end</code> with blocks that span multiple lines:</p>
<pre><code class="ruby">yell = lambda { puts "AAARGH!!!" }
whisper = Proc.new do
 puts "whee"
end
yell.call
whisper.call
</code></pre>
<p>âž¥</p>
<pre><code class="ruby">AAARGH!!!
whee</code></pre>
<p>Maybe the most useful application of <code>Proc</code> objects in Ruby are block parameters. Anyone with some knowledge of Ruby is familiar with the following:</p>
<pre><code class="ruby">&gt;&gt; arr = %w(apple orange kiwi)
=&gt; ["apple", "orange", "kiwi"]
&gt;&gt; arr.each {|i| puts i[0,2]}
ap
or
ki
=&gt; ["apple", "orange", "kiwi"]</code></pre>
<p>As you can see, in this case you need to use neither <code>Proc.new</code> nor <code>lambda</code> with the block; it&#8217;s converted to a <code>Proc</code> object implicitly. But as the method receives just a <code>Proc</code> object as its parameter, you could also say something like this, right:</p>
<pre><code class="ruby">&gt;&gt; put_two = lambda {|i| puts i[0,2]}
=&gt; #&lt;Proc:0x00329060@(irb):41&gt;
&gt;&gt; arr.each(put_two)</code></pre>
<p>Err, not quite. It turns out Ruby methods can take two kinds of parametersâ€”a number of normal parameters and a block parameter. In the code above the interpreter will think that the <code>put_two</code> <code>Proc</code> object is passed as a normal parameter to the <code>each</code> call, and since <code>each</code> doesn&#8217;t take any normal parameters, you will get an error:</p>
<pre><code class="ruby">&gt;&gt; arr.each(put_two)
ArgumentError: wrong number of arguments (1 for 0)
	from (irb):42:in `each'
	from (irb):42</code></pre>
<p>And this is what brings us back to the ampersand:</p>
<pre><code class="ruby">&gt;&gt; arr.each(&amp;put_two)
ap
or
ki
=&gt; ["apple", "orange", "kiwi"]</code></pre>
<p>So <strong>the ampersand is used to tell the interpreter that the following reference is the block parameter of the method</strong>.</p>
<p>One fairly common idiom in the Rails world is this kind of construct:</p>
<pre><code class="ruby">&gt;&gt; arr.map(&amp;:length)</code></pre>
<p>It is effectively the same as</p>
<pre><code class="ruby">&gt;&gt; arr.map {|i| i.length }
=&gt; [5, 6, 4]</code></pre>
<p>However, if you start a plain irb session, you will notice something isn&#8217;t quite right:</p>
<pre><code class="ruby">&gt;&gt; arr.map(&amp;:length)
TypeError: wrong argument type Symbol (expected Proc)
	from (irb):2</code></pre>
<p>That&#8217;s right. The cool shorthand method that worked so nicely in your Rails app doesn&#8217;t work in plain Ruby. That&#8217;s because there is some Rails magic behind the <code>&amp;:method</code> call. This magic is e.g. the reason why <a href="http://goruco2008.confreaks.com/06_zygmuntowicz.html">Ezra has prohibited using the shortcut in Merb framework code</a>.</p>
<p>But let&#8217;s have a closer look at what&#8217;s actually happening behind the scenes in the shortcut. The thing that&#8217;s different from our earlier calls is that there is a colon between the ampersand and the word &#8220;length&#8221;. This means that we&#8217;re not using a variable or method called <code>length</code>, but the symbol <code>:length</code>. If you&#8217;re not familiar with Ruby symbols (or even if you are), reading <a href="http://blog.hasmanythrough.com/2008/4/19/symbols-are-not-pretty-strings">Josh&#8217;s recent article on symbols</a> is a worthwhile read.</p>
<p>Now that we know that we&#8217;re trying to pass a symbol as the block parameter to a method (and that it&#8217;s not really working, as the error above indicates), we need a way to convert it to a <code>Proc</code> object like expected by the method. Ruby has a slew of type conversion methods that are called implicitly whenever it&#8217;s clear that a certain type of object is needed. Inside a string for example, <code>to_s</code> is called automatically for every object that is not a string itself:</p>
<pre><code class="ruby">&gt;&gt; "Nice array: " + arr
TypeError: can't convert Array into String
	from (irb):6:in `+'
	from (irb):6
&gt;&gt; "Nice array: #{arr}"
=&gt; "Nice array: appleorangekiwi"
&gt;&gt; "Nice array: " + arr.to_s
=&gt; "Nice array: appleorangekiwi"</code></pre>
<p>In the same vein, since a block parameter of a method needs to be a <code>Proc</code> object, <code>to_proc</code> is called automatically for all other objects in an effort to get a hold of a proc.  So could it work if we just added a <code>to_proc</code> method to the <code>Symbol</code> class? Let&#8217;s find out!</p>
<pre><code class="ruby">class Symbol
  def to_proc
    lambda {|i| i.send(self)}
  end
end</code></pre>
<p><del>Here we make <code>to_proc</code> a lambda function that will use the <code>send</code> method to call the method with the same name as the <code>Symbol</code> object in question (self) for the element that&#8217;s passed to it.</del> <em>(That got too confusing so let&#8217;s just use examples)</em>.  So</p>
<pre><code class="ruby">arr.send(:length)</code></pre>
<p>is the same as</p>
<pre><code class="ruby">arr.length</code></pre>
<p>And thus</p>
<pre><code class="ruby">:length.to_proc</code></pre>
<p>would become</p>
<pre><code class="ruby">lambda {|i| i.send(:length)}</code></pre>
<p>Now, let&#8217;s see how our new method performs:</p>
<pre><code class="ruby">&gt;&gt; arr.map(&amp;:reverse)
=&gt; ["elppa", "egnaro", "iwik"]</code></pre>
<p>Perfect!</p>
<p>While <code>Symbol#to_proc</code> is a clever and perhaps an elegant hack, it&#8217;s still kind of a hack. So should you use it in your code? I tend to side with Ezra on this. If you&#8217;re writing framework code, you should probably err on the side of readability and common usage, and thus avoid &#8220;magical shortcuts&#8221; like these. But in application code, why not. I certainly do.</p></div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2008/05/05/making-capistrano-not-pant-on-cleanup/">Making Capistrano Not Suffocate on Cleanup</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2008-05-05T00:00:00+03:00" pubdate data-updated="true">May 5<span>th</span>, 2008</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>When trying to deploy an app on the production server, the <code>deploy:cleanup</code> task always died for me like this:</p>
<pre><code>  * executing `deploy:cleanup'
  * executing "ls -x /opt/sites/mysite/releases"
    servers: ["myserver"]
    [myserver] executing command
    command finished
 ** keeping 3 of 4 deployed releases
  * executing "rm -rf /opt/sites/mysite/releases/20080220092659"
    servers: ["myserver"]
    [myserver] executing command
 ** [out :: myserver] sudo: no passwd entry for app!
 ** [out :: myserver] 
    command finished
command "rm -rf /opt/sites/mysite/releases/20080220092659" failed on myserver
</code></pre>
<p>Turns out capistrano is for some reason trying to use a user called <em>app</em> in the cleanup task even though the <code>:user</code> parameter is set to something else in <code>config/deploy.rb</code>. The solution was to set the <code>:runner</code> parameter as well:</p>
<pre><code class="ruby">set :runner, 'someotheruser'
</code></pre>
<p>Don&#8217;t ask me why that worked. It seems a bit counterintuitive that the cleanup task uses the <code>runner</code> param rather than <code>user</code>. Found the hint towards the solution <a href="http://groups.google.com/group/capistrano/browse_thread/thread/0d396a96d1946ba3">here</a>.</p></div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2008/04/22/hate-to-say/">Hate to Say&#8230;</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2008-04-22T00:00:00+03:00" pubdate data-updated="true">Apr 22<span>nd</span>, 2008</time>
        
      </p>
    
  </header>


  <div class="entry-content"><h3>December 2007</h3>
<blockquote>
<p>For gawd&#8217;s sake, what did they smoke in your company&#8217;s Christmas party?</p>
</blockquote>
<p><em>(A text message I sent to my buddy Thomas who works in Sampo Pankki in reference to the news that the bank (recently bought by Danske Bank) would deploy a new &#8220;security&#8221; system (that uses a Java applet) in their online banking solution).</em></p>
<h3>April 2008</h3>
<blockquote>
<p>The latest reactions inclule [sic] 52-year old male customer returing to the bank with an axe after hearing that his account is empty, money exchange company Forex stopping accepting payment cards from Sampo Bank and Sampo Bank customers not being able to buy train tickets online.</p>
</blockquote>
<p>(<a href="http://janne.blogit.kauppalehti.fi/2008/04/03/finnish-sampo-banks-ict-problems-cause-extreme-reactions-in-their-clientele/">Finnish Sampo Bankâ€™s <span class="caps">ICT</span> problems cause extreme reactions in their clientele</a>)</p></div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2008/03/11/on-multitasking/">On Multitasking</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2008-03-11T00:00:00+02:00" pubdate data-updated="true">Mar 11<span>th</span>, 2008</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Now, this has been <a href="http://www.joelonsoftware.com/articles/fog0000000022.html">talked about in detail in the past</a>, but here are two recent interesting discussions about multitasking. On the <a href="http://podcast.rubyonrails.org/">Ruby on Rails Podcast</a>, Geoff interviews Dr. John Medina in a &quot;two-part series about his new book, <a href="http://brainrules.net/">Brain Rules: 12 Principles for Surviving and Thriving at Work, Home, and School</a>.</p>
<p>One of the most interesting topic in the discussion is about human multitasking, and to be precise, the lack of it. One of the hot topics in this discussion is the debate about talking in phone while driving. Medina brings up <a href="http://unews.utah.edu/p/?r=062206-1">recent studies</a> that show talking while driving is as dangerous as drunk-driving, <em>no matter whether you use a hands-free set or not</em>. As a reason, Medina proposes that when discussing with someone remote interactively, you build a mental image of the counterpart (just like you do when reading a novel) which takes your concentration away from driving. That sounds certainly believable. I have many times noticed that I&#8217;ve been driving for minutes while talking in the phone (with the iPhone headset, of course) and then suddenly kind of wake up back to the traffic.</p>
<p>Meanwhile, <a href="http://www.randsinrepose.com/archives/2008/03/06/i_dont_multitask.html">Rands explains how he <em>doesn&#8217;t</em> multitask</a> even though it might appear as if he would to the outsider.</p></div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2008/02/13/a-few-photo-fyi-s/">A Track of Two</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2008-02-13T00:00:00+02:00" pubdate data-updated="true">Feb 13<span>th</span>, 2008</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>If you&#8217;re into photography, here&#8217;s a couple of quick links that might be of interest:</p>
<ol>
	<li>Scott Bourne and Alex Lindsay, of <a href="http://www.twit.tv/mbw">MacBreak Weekly</a> and many other fames, have started a new podcast under the <a href="http://www.pixelcorps.tv/">Pixelcorps.tv</a> umbrella: <a href="http://twipphoto.com/">This Week in Photography</a>. The guys are really great podcasters and the content is kind of semi-advanced so that it&#8217;s not boring even if you&#8217;re fairly competent (even pro, I would say) but also not overwhelmingly technical. Great stuff during long exercises like a track of two<sup class="footnote" id="fnr1"><a href="#fn1">1</a></sup>. The third episode of <span class="caps">TWIP</span> discussed the state of Aperture and namely the lack of announcement of version 2 during the <a href="http://www.pmai.org/index.cfm/ci_id/33573.htm"><span class="caps">PMA</span></a>. That gives us a nice segue to the next topic:</li>
	<li><a href="http://www.apple.com/aperture/">Aperture 2</a> is here! Downloading it right now and have high hopes for the performance. Especially creating previews and exporting photos leaves a lot to be desired in 1.5, and if the first comments around the &#8217;net are to be trusted, the newcomer should be vastly better in this regard.</li>
</ol>
<p class="footnote" id="fn1"><a href="#fnr1"><sup>1</sup></a> A track of two (or &#8220;kakkosen latu&#8221; in Finnish) is a term that came from a two-hour cross-country skiing (preferably classic) exercise and is now a synonym for any longer training pass (run, ski, hike, whatever) of around or over two hours.</p></div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2008/02/12/the-stupid-thing-aka-region-codes/">The Best of Times, the Worst of Times</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2008-02-12T00:00:00+02:00" pubdate data-updated="true">Feb 12<span>th</span>, 2008</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>I&#8217;m kind of sad that Blu-ray has taken the lead in the next generation digital video disc race, and that has little to do with the fact that <a href="http://en.wikipedia.org/wiki/Sony_BMG#Controversy">I don&#8217;t really like Sony</a>. The reason <a href="http://arstechnica.com/news.ars/post/20080211-best-buy-netflix-join-hd-dvd-dogpile.html">the lurking death of HD <span class="caps">DVD</span></a> makes me really sad is that while it has smaller capacity than BD, it has one thing really going for it: <strong>it&#8217;s void of one of the pests of modern times: regional codes.</strong></p>
<p><a href="http://adactio.com/journal/1404">Jeremy Keith recently wrote</a> about DVD&#8217;s and Wii games that he bought during his Christmas trip to US <em>that he cannot use</em> because they are limited to be played only by a player with the US region code. Now, there are region code-free players available, but that only makes the whole scheme more pointless.</p>
<p>Now, with HD <span class="caps">DVD</span> being free of the region codes, we could have gotten rid of them once and for all. However, with Blu-ray seemingly winning the war, we seem to be stuck with the same hassle into the unforeseeable future. And people wonder why Pirate Bay is the #1 movie distribution channel in Europe these days&#8230;</p></div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2008/01/15/note-to-self-when-autotest-fails/">Note to Self: When Autotest Fails&#8230;</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2008-01-15T00:00:00+02:00" pubdate data-updated="true">Jan 15<span>th</span>, 2008</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>I just run into the following error when running autotest within a Rails app:</p>
<pre><code>
/Users/jarkko/Sites/koulutusweb/vendor/rails/activerecord/lib/../../activesupport/lib/active_support/dependencies.rb:402:in `to_constant_name': Anonymous modules have no name to be referenced by (ArgumentError)
	from /Users/jarkko/Sites/koulutusweb/vendor/rails/activerecord/lib/../../activesupport/lib/active_support/dependencies.rb:214:in `qualified_name_for'
	from /Users/jarkko/Sites/koulutusweb/vendor/rails/activerecord/lib/../../activesupport/lib/active_support/dependencies.rb:477:in `const_missing'
	from /Users/jarkko/Sites/koulutusweb/vendor/plugins/rspec/lib/spec/example/example_group_factory.rb:7:in `reset'
	from /Users/jarkko/Sites/koulutusweb/vendor/plugins/rspec/lib/spec/example/example_group_factory.rb:59
	from /Library/Ruby/Site/1.8/rubygems/custom_require.rb:27:in `gem_original_require'
	from /Library/Ruby/Site/1.8/rubygems/custom_require.rb:27:in `require'
	from /Users/jarkko/Sites/koulutusweb/vendor/rails/activerecord/lib/../../activesupport/lib/active_support/dependencies.rb:496:in `require'
	from /Users/jarkko/Sites/koulutusweb/vendor/rails/activerecord/lib/../../activesupport/lib/active_support/dependencies.rb:342:in `new_constants_in'
	 ... 59 levels...
	from /Library/Ruby/Gems/1.8/gems/rspec-1.0.8/lib/spec/runner/command_line.rb:17:in `run'
	from /Library/Ruby/Gems/1.8/gems/rspec-1.0.8/bin/spec:3
	from /usr/bin/spec:19:in `load'
	from /usr/bin/spec:19
</code></pre>
<p>It turned out I had typed &#8220;sudo gem update zentest&#8221; to get the latest version of the gem. However, the correct way would have been to use the camel-cased version ZenTest. The funny thing is, that if you run the command in lower case (like I&#8217;m use to do with RubyGems), you <em>will</em> get ZenTest, it&#8217;s just version 3.5.0 (as opposed to 3.8 that I supposedly got).</p>
<p>So here&#8217;s hoping that the next time I do the same mistake, this page will pop up from the big G.</p></div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2008/01/09/sony-bmg-goes-drm-free-or-sony-bmg-the-dumbest-of-the-dumb/">Sony BMG &#8220;Goes DRM-free&#8221; (or: Sony BMG, the Dumbest of the Dumb)</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2008-01-09T00:00:00+02:00" pubdate data-updated="true">Jan 9<span>th</span>, 2008</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>(cross-posted to <a href="http://dotherightthing.com/entries/1481-sony-bmg-goes-drm-free-or-sony-bmg-the-dumbest-of-the-dumb">dotherightthing.com</a>)</p>
<p>Last weeks, the air has been thick about even Sony <span class="caps">BMG</span>, the last of the big four music labels finally abandoning it&#8217;s rootkit-stained history of draconian <span class="caps">DRM</span> schemes and publishing &#8220;at least part of its collection&#8221; available <span class="caps">DRM</span>-free&quot;:http://www.businessweek.com/technology/content/jan2008/tc2008013_398775.htm. However, the actual way of how it&#8217;s going to happen has been unclear until very recently. And boy, what scheme that <a href="http://www.usatoday.com/money/media/2008-01-07-sony-music_N.htm">came to be</a>:</p>
<blockquote>
<p>The No. 2 record company after Universal Music will sell plastic cards, called Platinum MusicPass, for individual albums for a suggested price of $12.99. Buyers enter a code from the card at new Sony <span class="caps">BMG</span> (<span class="caps">SNE</span>) site MusicPass.com to download that card&#8217;s album.</p>
</blockquote>
<p>That&#8217;s right. Plastic frikkin&#8217; cards. Marco has a <a href="http://www.marco.org/275">good view of how this happens</a>:</p>
<blockquote>
<p>To get Sony BMGâ€™s <span class="caps">DRM</span>-free music files, someone burns some coal to manufacture these petroleum-based plastic cards, then delivers them to stores on a series of diesel trucks. I drive to Best Buy in my 3056-pound gas-burning car and find my particular little plastic card, assuming that store carries the album I want in plastic-card format and itâ€™s in stock. (If not, I need to drive to more stores, or just give up and try again next weekend.) But they probably have these cards taking up space somewhere in their massive store that requires tons of energy to keep well-lit and ventilated (since it has no windows).</p>
</blockquote>
<p>And as far as the &#8220;part of the collection&#8221; part goes, the <span class="caps">DRM</span>-free collection will be a whopping 37 albums. Three-seven. Combining the convenience of going to a store to be able to buy tunes online, and the width of the supply, I&#8217;m sure people will be buying the albums like crazy.</p>
<p>John Gruber <a href="http://daringfireball.net/linked/2008/january#tue-08-scalzi">links</a> to an article by John Scalzi, aptly titled <a href="http://scalzi.com/whatever/?p=280">Why It Won&#8217;t Work</a>.</p>
<blockquote>
<p><strong>Kid #2:</strong> So to recap, what youâ€™ve got here is a system that makes people leave their house in order to download music at their house, and makes them go to a store to get music that they could get at the store, somewhere else.</p>
<p><strong>Sony <span class="caps">BMG</span> dude:</strong> Er.</p>
<p><strong>Kid #1:</strong> Why donâ€™t you just sell non-DRMâ€™d MP3s off Amazon, like every other major music corporation?</p>
<p><strong>Sony <span class="caps">BMG</span> dude:</strong> Well.</p>
<p><strong>Kid #2:</strong> You donâ€™t actually want to sell unprotected MP3s, do you? You want to be able to say youâ€™re doing it, but really, you want to make it so ridiculously inconvenient that people keep just keep buying CDs and DRMâ€™d tracks off iTunes. Just admit it, bro.</p>
<p><strong>Sony <span class="caps">BMG</span> dude (pointing):</strong> Look! Itâ€™s Celine Dion! And Barry Manilow! (runs away as kids avert their eyes in terror)</p>
</blockquote>
<p>Won&#8217;t they ever learn?</p>
<p><strong>[<span class="caps">UPDATE</span>:]</strong> They will indeed <a href="http://www.macworld.com/article/131515/2008/01/amazon.html">start selling music through Amazon MP3, according to MacWorld</a>. The question remains, why on earth did they publicize the born dead plastic card scheme if the whole Amazon deal was about to be announced. The other question is, doesn&#8217;t it sound like a cartel that three of the big four labels refuse to sell Apple <span class="caps">DRM</span>-free songs but sell them somewhere else? Let&#8217;s hope there are some announcements coming next week in San Francisco.</p></div>
  
  


    </article>
  
  <div class="pagination">
    
      <a class="prev" href="/blog/page/4/">&larr; Older</a>
    
    <a href="/blog/archives">Blog Archives</a>
    
    <a class="next" href="/blog/page/2/">Newer &rarr;</a>
    
  </div>
</div>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2012 - Jarkko Laine -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>



<script type="text/javascript">
  var _gauges = _gauges || [];
  (function() {
    var t   = document.createElement('script');
    t.type  = 'text/javascript';
    t.async = true;
    t.id    = 'gauges-tracker';
    t.setAttribute('data-site-id', '50b05efb613f5d7127000040');
    t.src = '//secure.gaug.es/track.js';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(t, s);
  })();
</script>

</body>
</html>
